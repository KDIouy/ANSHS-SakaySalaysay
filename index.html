<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ANSHS SakaySalaysay</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; background:#f4f4f4; margin:0; padding:0;}
    .container { max-width:600px; margin:20px auto; padding:20px; background:white; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
    input, select, textarea, button { width:100%; margin:5px 0; padding:10px; border-radius:5px; border:1px solid #ccc;}
    button { background:#007bff; color:white; border:none; cursor:pointer;}
    button:hover { background:#0056b3;}
    .review { border-bottom:1px solid #ccc; padding:10px 0;}
  </style>
</head>
<body>
  <div class="container">
    <h2>ANSHS SakaySalaysay</h2>
    <input type="text" id="username" placeholder="Your Name">
    
    <h3>Write a Review</h3>
    <input type="text" id="subject" placeholder="Subject">
    <input type="text" id="route" placeholder="Route (e.g., Alabel Terminal)">
    <select id="transit">
      <option>Dyip</option>
      <option>Multicab</option>
    </select>
    <select id="category">
      <option>Sobrang Pamasahe</option>
      <option>Siksikan</option>
      <option>Nakaharang na Gulong</option>
      <option>Bilis ng Pagmamaneho</option>
      <option>Iba Pa</option>
    </select>
    <textarea id="message" placeholder="Message"></textarea>
    <button onclick="submitReview()">Submit Review</button>
    
    <h3>All Reviews</h3>
    <div id="reviews"></div>
  </div>

  <!-- Firebase Compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDZUUgvFcgetmmRfUlY0-DYrj3PPRWqMpo",
      authDomain: "sakaysalaysay-9c1d1.firebaseapp.com",
      projectId: "sakaysalaysay-9c1d1",
      storageBucket: "sakaysalaysay-9c1d1.firebasestorage.app",
      messagingSenderId: "118192351425",
      appId: "1:118192351425:web:19cedc542aeef807098c40"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Submit a review
    function submitReview() {
      const username = document.getElementById("username").value.trim();
      const subject = document.getElementById("subject").value.trim();
      const route = document.getElementById("route").value.trim();
      const transit = document.getElementById("transit").value;
      const category = document.getElementById("category").value;
      const message = document.getElementById("message").value.trim();

      if(!username || !subject || !route || !message){
        alert("Pakipunan lahat ng field.");
        return;
      }

      db.collection("reviews").add({
        user: username,
        subject,
        route,
        transit,
        category,
        message,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        document.getElementById("subject").value = "";
        document.getElementById("route").value = "";
        document.getElementById("message").value = "";
      });
    }

    // Load reviews in real-time
    db.collection("reviews").orderBy("timestamp","desc").onSnapshot(snapshot => {
      const reviewsDiv = document.getElementById("reviews");
      reviewsDiv.innerHTML = "";
      snapshot.forEach(doc => {
        const r = doc.data();
        reviewsDiv.innerHTML += `
          <div class="review">
            <h4>${r.subject} (${r.route} - ${r.transit})</h4>
            <p>${r.message}</p>
            <p><b>By:</b> ${r.user} | <b>Category:</b> ${r.category}</p>
          </div>
        `;
      });
    });
  </script>
</body>
</html>